worker_processes 1;
events {
    worker_connections 1024;
}
http {
    server {
        listen 443 ssl http2;
        server_name localhost;

        # The startup script will insert the resolver directive here for dev mode
        ##RESOLVER_DIRECTIVE##

        ssl_certificate      /etc/nginx/certs/localhost.pem;
        ssl_certificate_key  /etc/nginx/certs/localhost-key.pem;

        location /api/ {
            # Use a variable for the backend URL
            proxy_pass $BACKEND_URL;

            proxy_set_header Host $host;
            proxy_set_header X-Real-IP $remote_addr;
            proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
            proxy_set_header X-Forwarded-Proto $scheme;
            proxy_buffering off;
            proxy_cache off;
        }

        # The startup script will replace this comment with the correct
        # frontend configuration based on the environment.
        ##FRONTEND_LOCATION_BLOCK##
    }
}