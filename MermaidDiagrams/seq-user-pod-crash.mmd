sequenceDiagram
    participant Kafka as Kafka Broker
    participant LeaderPod as User Service (Leader Pod)
    participant WorkerPod1 as User Service (Worker Pod 1)
    participant WorkerPod2 as User Service (Worker Pod 2)
    participant UserUI as User UI (for user-abc)

    Note over Kafka, LeaderPod: 1- A single orchestration event is consumed by the Leader. <br/> The Leader scatters user-specific events back to Kafka.

    Kafka->>+WorkerPod1: 2- Delivers user-specific CREATED event <br/> for "user-abc"
    
    Note over WorkerPod1: 3- Pod begins processing...
    
    Note over WorkerPod1: 4- POD CRASHES! <br/> The message is NOT acknowledged.
    
    WorkerPod1--xKafka: Connection Lost
    
    Note over Kafka: 5- Consumer group rebalances due to lost member. <br/> The unacknowledged message for "user-abc" is reassigned.
    
    Kafka->>+WorkerPod2: 6- Redelivers the SAME event for "user-abc" <br/> to a new, healthy pod.
    
    WorkerPod2->>+UserUI: 7- Successfully pushes message via SSE
    UserUI-->>-WorkerPod2: 
    
    WorkerPod2->>+Kafka: 8- Acknowledges the message
